---
# =============================================================================
# ANSIBLE VAULT - ENCRYPTED SECRETS (CENTRALIZED VERSION MANAGEMENT)
# =============================================================================
# To create this file:
#   ansible-vault create group_vars/all/secrets.yml
#
# To edit:
#   ansible-vault edit group_vars/all/secrets.yml
#
# To view:
#   ansible-vault view group_vars/all/secrets.yml
# =============================================================================

# =============================================================================
# AUTHENTICATION TOKENS
# =============================================================================

# --- GITHUB TOKEN (Required for Docker Image Pull & Validation) ---
# Generate at: https://github.com/settings/tokens
# Scopes needed:
#   - repo (if using private repos)
#   - read:packages (for GitHub Container Registry)
# Used for:
#   - Pulling custom Caddy image: ghcr.io/miguel-devops/caddy-waf:v2.11
#   - Repository validation
vault_github_token: "GITHUB_TOKEN_GOES_HERE"

# --- TAILSCALE AUTH KEY (Required for VPN) ---
# Generate at: https://login.tailscale.com/admin/settings/keys
# Options:
#   - Reusable: Yes (for multiple servers)
#   - Ephemeral: No (keeps nodes in admin panel)
#   - Tags: Add tags for ACL policies (optional)
#   - Expiration: 90 days or never
tailscale_auth_key: "TAILSCALE_AUTH_KEY_GOES_HERE"

# --- PORTAINER EDGE AGENT KEY (Required for Edge Agent deployment) ---
# Generate in Portainer UI: Environments → Add environment → Edge Agent
# This token allows Edge Agents to connect to Portainer server
portainer_edge_key: "PORTAINER_EDGE_KEY_GOES_HERE"

# --- TAILSCALE ACL API KEY (Optional - for automated ACL management) ---
# Generate at: https://login.tailscale.com/admin/settings/keys
# Required scopes: ACL read/write
# Note: Optional - leave undefined to skip automated ACL configuration
tailscale_acl_key: "TAILSCALE_ACL_KEY_GOES_HERE"
tailscale_tailnet: "your-tailscale-tailnet.example.com"  # e.g., example.ts.net

# --- CROWDSEC CONSOLE KEY (Optional - for hybrid signal sharing) ---
# Generate at: https://app.crowdsec.net/
# Used for:
#   - Hybrid signal sharing between OCI and Hetzner nodes
#   - Centralized threat intelligence
# Note: Optional - leave undefined for local-only detection
# crowdsec_console_key: "CROWDSEC_CONSOLE_KEY_GOES_HERE"


# =============================================================================
# VERSION PINNING - CENTRALIZED CONTROL
# =============================================================================

# --- DOCKER ENGINE VERSIONS (CRITICAL - ALWAYS PIN) ---
# Find versions at:
#   Debian: https://download.docker.com/linux/debian/dists/bookworm/pool/stable/arm64/
#   Ubuntu: https://download.docker.com/linux/ubuntu/dists/jammy/pool/stable/arm64/
#
# Format: "5:VERSION-1~DISTRO.RELEASE~CODENAME"
# Latest stable: 27.5.1 (2026-01)
docker_version_map:
  Debian:
    bookworm: "5:27.5.1-1~debian.12~bookworm"  # Debian 12 (current)
    bullseye: "5:27.5.1-1~debian.11~bullseye"  # Debian 11 (legacy)
  Ubuntu:
    jammy: "5:27.5.1-1~ubuntu.22.04~jammy"     # Ubuntu 22.04 LTS
    noble: "5:27.5.1-1~ubuntu.24.04~noble"     # Ubuntu 24.04 LTS

# --- TAILSCALE VERSION (OPTIONAL - AUTO-UPDATE RECOMMENDED FOR SECURITY) ---
# Find versions: https://pkgs.tailscale.com/stable/debian/bookworm/pool/
#
# Options:
#   - "*"       - Auto-update to latest (RECOMMENDED for security)
#   - "1.58.2"  - Specific stable version
#   - "1.60.0"  - Newer version
#
# Note: VPN security updates are critical, consider auto-update
# Latest stable: 1.58.2
tailscale_version: "*"  # Auto-update enabled

# =============================================================================
# OPENTOFU/TERRAFORM PROVIDER VERSIONS (Defined in tofu/versions.tf)
# =============================================================================
# These are managed in tofu/versions.tf but documented here for reference:
#
# terraform_version: ">= 1.6.0, < 2.0.0"
# provider_versions:
#   oracle_oci: "~> 6.24.0"      # Oracle Cloud Infrastructure
#   hetzner_hcloud: "~> 1.49.0"  # Hetzner Cloud
#   hashicorp_local: "~> 2.5.0"  # Local file generation
#   hashicorp_template: "~> 2.2.0"  # Template rendering
#
# Update by editing tofu/versions.tf directly

# =============================================================================
# OPERATING SYSTEM VERSIONS (Defined in tofu/variables.tf)
# =============================================================================
# These are managed in tofu/variables.tf but documented here for reference:
#
# hetzner_image: "debian-12"      # Debian 12 Bookworm
# oci_os_version: "22.04"         # Ubuntu 22.04 LTS Jammy
#
# Update by editing tofu/variables.tf or tofu/terraform.tfvars

# =============================================================================
# VERSION LOCK FILE (Update when changing versions)
# =============================================================================
# Last updated: 2026-01-16
# Docker: 27.4.1
# Tailscale: Auto-update (*)
# Tofu Providers: OCI 6.24.x, Hetzner 1.49.x
# OS Images: Debian 12, Ubuntu 22.04 LTS
# =============================================================================
